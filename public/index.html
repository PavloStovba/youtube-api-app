<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <title>YouTube API App</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <h1>üé¨ YouTube Search App</h1>

        <form id="searchForm" class="search-box">
            <input type="text" id="query" placeholder="–í–≤–µ–¥—ñ—Ç—å –∑–∞–ø–∏—Ç (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: cats)" required>
            <button type="submit">üîç –ü–æ—à—É–∫</button>
        </form>

        <div id="result" class="result"></div>

        <h2>üìå –ó–±–µ—Ä–µ–∂–µ–Ω—ñ –≤—ñ–¥–µ–æ:</h2>
        <div id="saved" class="saved"></div>
    </div>

    <script>
        const form = document.getElementById("searchForm");
        const resultDiv = document.getElementById("result");
        const savedDiv = document.getElementById("saved");

        async function loadSaved() {
            const res = await fetch("/saved");
            const videos = await res.json();
            savedDiv.innerHTML = "";
            videos.forEach(v => {
                const card = document.createElement("div");
                card.className = "video-card";
                card.innerHTML = `
          <iframe src="https://www.youtube.com/embed/${v.videoId}" frameborder="0" allowfullscreen></iframe>
          <p>${v.title}</p>
        `;
                savedDiv.appendChild(card);
            });
        }

        form.addEventListener("submit", async(e) => {
            e.preventDefault();
            const query = document.getElementById("query").value;

            const res = await fetch(`/search?q=${encodeURIComponent(query)}`);
            const data = await res.json();

            if (data.videoId) {
                resultDiv.innerHTML = `
          <div class="video-card">
            <iframe src="https://www.youtube.com/embed/${data.videoId}" frameborder="0" allowfullscreen></iframe>
            <p>${data.title}</p>
          </div>
        `;
                loadSaved();
            } else {
                resultDiv.innerHTML = "<p>–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</p>";
            }
        });

        loadSaved();
    </script>
</body>

</html>